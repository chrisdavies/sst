"use strict";function initializeStore(t,e,r,n){for(var a in r){var i=r[a];if("$"===a[0])t.$selectors[a]=buildSelector(t,"",a,i);else if("function"==typeof i)t.$transform[a]=buildAction(t,"",a,i,n);else{var o=buildNested(t,a,i,n);e.state[a]=i.initialState(e.state[a]),t.$transform[a]=o.transform,t.$selector[a]=o.selector}}}function buildNested(t,e,r,n){var a={},i={};for(var o in r)"$"===o[0]?i[o]=buildSelector(t,e,o,r[o]):a[o]=buildAction(t,e,o,r[o],n);return{transform:a,selector:i}}function buildSelector(t,e,r,n){return function(){var r=nextArgs(t,e,arguments);return n.apply(null,r)}}function buildAction(t,e,r,n,a){return assertValidProp(r),function(){return a({store:t,stateProp:e,actionName:r,action:n,args:arguments})}}function assertValidProp(t){var e=/^\_/;if(e.test(t))throw"Invalid property "+t+". Properties cannot start with _"}function buildMiddleware(t){for(var e=leafMiddleware,r=t.length-1;r>=0;--r)e=makeMiddleware(t[r],e);return e}function makeMiddleware(t,e){return function(r){return t(r,e)}}function leafMiddleware(t){function e(t){if(r){var e=Object.assign({},n.getState());e[r]=t,n.setState(e)}else n.setState(t);return t}var r=t.stateProp,n=t.store,a=nextArgs(n,r,t.args),i=t.action.apply(null,a);if("function"==typeof i)return i(n);if(void 0===i)throw"An action returned an undefined state. Actions should return a valid state or null.";return i&&"function"==typeof i.then?i.then(e):void e(i)}function nextArgs(t,e,r){var n=e?t.getState()[e]:t.getState();return Array.prototype.concat.apply([n],r)}module.exports=function(t,e,r){r=r||[];var n={state:Object.assign({},t)},a=buildMiddleware(r),i={$transform:{},$selector:{},getState:function(){return n.state},setState:function(t){return n.state=t,i.onChange&&i.onChange(t),t}};return initializeStore(i,n,e,a),i};
//# sourceMappingURL=sst.min.js.map