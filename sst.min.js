"use strict";function initializeStore(t,e,n,r){for(var i in n){var a=n[i];if("$"===i[0])t.selectors[i]=buildSelector(t,"",i,a);else if("function"==typeof a)t.actions[i]=buildAction(t,"",i,a,r);else{var o=buildNested(t,i,a,r);e.state[i]=a.initialState(e.state[i]),t.actions[i]=o.actions,t.selectors[i]=o.selectors}}}function buildNested(t,e,n,r){var i={},a={};for(var o in n)"$"===o[0]?a[o]=buildSelector(t,e,o,n[o]):i[o]=buildAction(t,e,o,n[o],r);return{actions:i,selectors:a}}function buildSelector(t,e,n,r){return function(){var n=nextArgs(t,e,arguments);return r.apply(null,n)}}function buildAction(t,e,n,r,i){return assertValidProp(n),function(){return i({store:t,stateProp:e,actionName:n,action:r,args:arguments})}}function assertValidProp(t){var e=/^\_/;if(e.test(t))throw"Invalid property "+t+". Properties cannot start with _"}function buildMiddleware(t){for(var e=leafMiddleware,n=t.length-1;n>=0;--n)e=makeMiddleware(t[n],e);return e}function makeMiddleware(t,e){return function(n){return t(n,e)}}function leafMiddleware(t){var e=t.stateProp,n=t.store,r=nextArgs(n,e,t.args),i=t.action.apply(null,r),a=!i||"function"!=typeof i.then;if("function"==typeof i&&(i=i(n)),void 0===i)throw"An action returned an undefined state. Actions should return a valid state or null.";if(!e&&a)n.setState(i);else if(a){var o=Object.assign({},n.getState());o[e]=i,n.setState(o)}return i}function nextArgs(t,e,n){var r=e?t.getState()[e]:t.getState();return Array.prototype.concat.apply([r],n)}module.exports=function(t,e,n){n=n||[];var r={state:Object.assign({},t)},i=buildMiddleware(n),a={actions:{},selectors:{},getState:function(){return r.state},setState:function(t){return r.state=t,a.onChange&&a.onChange(t),t}};return initializeStore(a,r,e,i),a};
//# sourceMappingURL=sst.min.js.map